<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>EditPage - FIT5225Assignment2</title>

    <meta name="description" content="Source code generated using layoutit.com">
    <meta name="author" content="LayoutIt!">

    <link href="css/bootstrap.min.css" rel="stylesheet">

  </head>
  <body>
	<nav class="navbar navbar-expand-lg navbar-light bg-light">
				 
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
			<span class="navbar-toggler-icon"></span>
		</button> <a class="navbar-brand" href="#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FIT5225Assignment2</font></font></a>
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="navbar-nav">
				<li class="nav-item">
					 <a class="nav-link" href="homePage.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Upload</font></font></a>
				</li>
				<li class="nav-item">
					 <a class="nav-link" href="searchPage.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Search</font></font><span class="sr-only"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（当时的）</font></font></span></a>
				</li>
				<li class="nav-item  active">
					<a class="nav-link" href="editPage.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Edit</font></font></a>
			   </li>
			</ul>
			
			<ul class="navbar-nav ml-md-auto">
				<li class="nav-item active">
					 <a class="nav-link" href="#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Logout</font></font><span class="sr-only"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（当时的）</font></font></span></a>
				</li>

			</ul>
		</div>
	</nav>
	<div class="container-fluid">
		
		<div class="row">
			<div class="col-md-12">
				<div class="row">
					<div class="col-md-12">
						<div class="jumbotron">
							<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
								Image Delete
							</font></font></h2>
							<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
								<strong>description:&nbsp;&nbsp;&nbsp;</strong>Input the URL of an image and the image and relevant entries will be removed from s3 and the database.
							</font></font></p>
							<input id="imageURL" class="form-control mr-sm-2" type="text">
							<br/>
							<button onclick="imageDelete()" class="btn btn-danger btn-block" type="button"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
								Delete
							</font></font></button>
						</div>
					</div>
					<div class="col-md-12">
						<div class="jumbotron">
							<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
								URL Result
							</font></font></h2>
							<p>
								<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
								<strong>description:&nbsp;&nbsp;&nbsp;</strong> If you hirst input low. Please ente
							
							</div>
						</div>

					</div>
				</div>
			</div>
		</div>
	</div>


    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
	<script>
		function imageDelete() {
            const apiUrl = " https://92dso1b1yl.execute-api.us-east-1.amazonaws.com/dev/deleteimage"
      		var imageURL = document.getElementById("imageURL").value;
			fetch(apiUrl, {
				method: "DELETE",
				headers: {
				'Content-Type': 'application/json'
				},
				body: JSON.stringify({
				httpMethod: "DELETE",
				queryStringParameters: {
					"s3-url": imageURL
				}
				})
			})
			.then(response => response.json())
			.then(data => {
				console.log(data);
				console.log(data.statusCode)
				if(data.statusCode == 200){
					alert('Delete Success!');
				}
				else if(data.statusCode == 400){
					alert('No match image!');
				}
				else{
					alert('Delete Failed!');
				}
				console.log(typeof(data.statusCode));
				document.getElementById("imageURL").value = "";
			})
			.catch(error => console.error(error));
        }
	</script>
  </body>
</html>